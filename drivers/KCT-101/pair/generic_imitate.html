<script>
var options = {
	template: '../lib/pair/imitate.html',
	id: 'generic_imitate',
	title: 'deviceClasses.generic_remote.views.generic_imitate.title',
	body: 'deviceClasses.generic_remote.views.generic_imitate.body',
	svg: '<?xml version="1.0" encoding="utf-8"?>\n<!-- Generator: Adobe Illustrator 17.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t width="270.67px" height="407.411px" viewBox="0 0 270.67 407.411" enable-background="new 0 0 270.67 407.411"\n\t xml:space="preserve" xmlns:pulse="-">\n<g>\n\t<path d="M135.335,407.411l-0.016,0c-7.382-0.07-14.606-2.676-21.471-7.744c-6.745-4.98-13.33-12.487-19.572-22.311l-0.03-0.05\n\t\tc-4.049-6.906-12.282-11.001-24.47-12.173c-1.607-0.155-3.309-0.26-5.061-0.315h-2.942c-26.076,0-43.559-18.13-48.949-30.316\n\t\tc-5.398-12.203-8.549-40.979-9.608-61.914l-0.278-5.474C1.494,238.664,0,209.245,0,180.4c0-39.785,1.409-80.651,3.867-112.122\n\t\tc1.469-18.818,5.04-31.529,11.578-41.215c7.92-11.733,20.445-18.914,38.29-21.954C73.309,1.776,113.702,0,135.335,0\n\t\tc21.633,0,62.025,1.776,81.6,5.109c17.845,3.039,30.37,10.221,38.29,21.954c6.538,9.685,10.108,22.396,11.578,41.215\n\t\tc2.457,31.469,3.866,72.336,3.866,112.122c0,28.851-1.494,58.276-2.94,86.732l-0.277,5.457c-1.059,20.935-4.21,49.711-9.607,61.914\n\t\tc-5.39,12.186-22.873,30.316-48.949,30.316h-2.942c-1.751,0.054-3.454,0.16-5.061,0.315c-12.188,1.171-20.421,5.267-24.47,12.173\n\t\tl-0.03,0.05c-6.242,9.824-12.827,17.331-19.572,22.311c-6.865,5.068-14.089,7.674-21.471,7.744L135.335,407.411z M97.037,375.636\n\t\tc11.945,18.792,24.83,28.388,38.298,28.523c13.469-0.135,26.353-9.731,38.298-28.523c4.611-7.842,13.678-12.464,26.95-13.74\n\t\tc1.684-0.162,3.466-0.273,5.297-0.329l0.05-0.001h2.967c13.979,0,24.391-5.562,30.663-10.227\n\t\tc6.796-5.056,12.52-11.841,15.311-18.151c5.218-11.797,8.289-40.105,9.333-60.763l0.277-5.457\n\t\tc1.443-28.416,2.936-57.799,2.936-86.568c0-39.705-1.406-80.48-3.857-111.869c-2.479-31.743-11.449-54.131-47.172-60.215\n\t\tc-19.398-3.304-59.537-5.063-81.054-5.063S73.679,5.012,54.281,8.316C18.558,14.4,9.588,36.788,7.109,68.531\n\t\tC4.658,99.921,3.253,140.696,3.253,180.4c0,28.762,1.492,58.14,2.935,86.55l0.278,5.475c1.045,20.657,4.116,48.965,9.334,60.763\n\t\tc2.791,6.31,8.515,13.096,15.311,18.151c6.272,4.665,16.684,10.227,30.663,10.227l3.017,0.001c1.831,0.056,3.613,0.167,5.297,0.329\n\t\tC83.358,363.171,92.425,367.794,97.037,375.636z M135.335,389.047c-10.341,0-18.441-4.516-18.441-10.281s8.1-10.281,18.441-10.281\n\t\tc10.34,0,18.441,4.516,18.441,10.281S145.675,389.047,135.335,389.047z M135.335,371.738c-8.951,0-15.188,3.704-15.188,7.028\n\t\tc0,3.324,6.238,7.028,15.188,7.028c8.951,0,15.188-3.704,15.188-7.028C150.523,375.442,144.285,371.738,135.335,371.738z"/>\n</g>\n<g>\n\t<path d="M124.881,48.425c-2.675-2.675-4.33-6.371-4.33-10.454c0-4.082,1.655-7.778,4.33-10.454c2.675-2.675,6.371-4.33,10.454-4.33\n\t\tc4.082,0,7.778,1.655,10.454,4.33c2.675,2.675,4.33,6.371,4.33,10.454c0,4.082-1.655,7.778-4.33,10.454\n\t\tc-2.675,2.675-6.371,4.33-10.454,4.33C131.253,52.755,127.557,51.101,124.881,48.425 M122.177,37.972\n\t\tc0,3.633,1.473,6.923,3.854,9.304c2.381,2.381,5.67,3.854,9.304,3.854c3.633,0,6.923-1.473,9.304-3.854\n\t\tc2.381-2.381,3.854-5.67,3.854-9.304c0-3.633-1.473-6.923-3.854-9.304c-2.381-2.381-5.67-3.854-9.304-3.854\n\t\tc-3.633,0-6.923,1.473-9.304,3.854C123.65,31.049,122.177,34.338,122.177,37.972z"/>\n</g>\n<g>\n\t<path pulse:initial="true" pulse:state="1" fill-rule="evenodd" clip-rule="evenodd" fill="#000000" d="M86.915,92.884v34.339c0,0.61-0.499,1.109-1.109,1.109h-1.572\n\t\tc-0.61,0-1.109-0.499-1.109-1.109V92.884c0-0.61,0.499-1.109,1.109-1.109h1.572C86.415,91.775,86.915,92.274,86.915,92.884\n\t\t M107.925,133.083c5.894-5.894,9.539-14.036,9.539-23.029s-3.645-17.136-9.539-23.029c-5.894-5.894-14.036-9.539-23.029-9.539\n\t\tc-8.993,0-17.136,3.645-23.029,9.539s-9.539,14.036-9.539,23.029s3.645,17.136,9.539,23.029c5.894,5.893,14.036,9.539,23.029,9.539\n\t\tS102.031,138.976,107.925,133.083z"/>\n</g>\n<g>\n\t<path pulse:state="0" fill-rule="evenodd" clip-rule="evenodd" fill="#000000" d="M165.628,110.053c0-11.127,9.02-20.146,20.146-20.146\n\t\ts20.146,9.02,20.146,20.146c0,11.127-9.02,20.146-20.146,20.146S165.628,121.18,165.628,110.053 M153.206,110.053\n\t\tc0,8.993,3.645,17.136,9.539,23.029c5.894,5.893,14.036,9.539,23.029,9.539c8.993,0,17.136-3.645,23.029-9.539\n\t\tc5.893-5.894,9.539-14.036,9.539-23.029s-3.645-17.136-9.539-23.029c-5.894-5.893-14.036-9.539-23.029-9.539\n\t\tc-8.994,0-17.136,3.645-23.029,9.539C156.851,92.918,153.206,101.06,153.206,110.053z M185.774,93.764\n\t\tc-8.996,0-16.289,7.293-16.289,16.289s7.293,16.289,16.289,16.289c8.996,0,16.289-7.293,16.289-16.289\n\t\tS194.771,93.764,185.774,93.764z"/>\n</g>\n<g>\n\t<path d="M135.335,283.954c-5.935,0-8.056-0.467-11.816-1.613c-13.336-4.065-25.373-10.794-35.776-20\n\t\tc-10.39-9.195-19.437-21.115-26.891-35.429c-7.438-14.286-13.499-31.361-18.013-50.751c-4.509-19.366-7.602-41.59-9.195-66.055\n\t\tl-0.002-0.03l0-0.03c0.083-10.722,1.354-18.66,4-24.982c2.985-7.133,7.92-12.586,15.088-16.67\n\t\tc14.544-8.287,39.248-11.823,82.604-11.823s68.06,3.536,82.604,11.823c7.168,4.084,12.104,9.537,15.088,16.67\n\t\tc2.646,6.322,3.917,14.26,4,24.982l-0.002,0.059c-1.593,24.465-4.687,46.689-9.195,66.055\n\t\tc-4.514,19.389-10.574,36.464-18.013,50.751c-7.453,14.314-16.5,26.234-26.891,35.429c-10.403,9.206-22.44,15.935-35.776,20\n\t\tC143.391,283.487,141.27,283.954,135.335,283.954z M35.27,110.03c3.174,48.715,12.267,87.785,27.025,116.13\n\t\tc14.709,28.251,35.467,46.629,61.698,54.624c3.595,1.096,5.627,1.542,11.341,1.542c5.714,0,7.747-0.446,11.341-1.542\n\t\tc26.231-7.996,46.989-26.374,61.698-54.624c14.759-28.345,23.851-67.415,27.026-116.13c-0.143-17.978-3.308-31.698-18.267-40.222\n\t\tc-14.282-8.137-38.745-11.61-81.798-11.61s-67.517,3.472-81.799,11.61C38.577,78.332,35.413,92.052,35.27,110.03z M185.774,144.248\n\t\tc-18.855,0-34.194-15.339-34.194-34.194s15.34-34.194,34.194-34.194c18.855,0,34.194,15.339,34.194,34.194\n\t\tS204.629,144.248,185.774,144.248z M185.774,77.485c-17.958,0-32.568,14.61-32.568,32.568s14.61,32.568,32.568,32.568\n\t\tc17.958,0,32.568-14.61,32.568-32.568S203.732,77.485,185.774,77.485z M84.896,144.248c-18.855,0-34.194-15.339-34.194-34.194\n\t\ts15.339-34.194,34.194-34.194s34.194,15.339,34.194,34.194S103.75,144.248,84.896,144.248z M84.896,77.485\n\t\tc-17.958,0-32.568,14.61-32.568,32.568s14.61,32.568,32.568,32.568c17.958,0,32.568-14.61,32.568-32.568\n\t\tS102.854,77.485,84.896,77.485z"/>\n</g>\n<g>\n\t<path fill-rule="evenodd" clip-rule="evenodd" fill="#000000" d="M122.177,37.972c0,3.633,1.473,6.923,3.854,9.304\n\t\tc2.381,2.381,5.67,3.854,9.304,3.854c3.633,0,6.923-1.473,9.304-3.854c2.381-2.381,3.854-5.67,3.854-9.304\n\t\tc0-3.633-1.473-6.923-3.854-9.304c-2.381-2.381-5.67-3.854-9.304-3.854c-3.633,0-6.923,1.473-9.304,3.854\n\t\tC123.65,31.049,122.177,34.338,122.177,37.972z"/>\n</g>\n<g>\n\t<path d="M135.335,51.332c-3.569,0-6.924-1.39-9.448-3.913c-2.523-2.523-3.913-5.879-3.913-9.448c0-3.569,1.39-6.924,3.913-9.448\n\t\tc2.524-2.523,5.879-3.913,9.448-3.913c3.569,0,6.924,1.39,9.447,3.913c2.524,2.523,3.913,5.879,3.913,9.448\n\t\ts-1.39,6.924-3.913,9.448C142.259,49.943,138.904,51.332,135.335,51.332z M135.335,25.017c-3.46,0-6.713,1.347-9.16,3.794\n\t\tc-2.447,2.447-3.794,5.7-3.794,9.16c0,3.46,1.347,6.713,3.794,9.16c2.447,2.447,5.7,3.794,9.16,3.794s6.713-1.347,9.16-3.794\n\t\tc2.447-2.447,3.794-5.7,3.794-9.16c0-3.46-1.347-6.714-3.794-9.16C142.048,26.365,138.795,25.017,135.335,25.017z"/>\n</g>\n</svg>\n',
	svgWidth: '80vw',
	svgHeight: '70vh',
	initWithDeviceData: false,
	previous: true,
	next: false
};
Homey.setTitle(__(options.title || ''));
Homey.emit('init', options.id);
Homey.on('show_view', function(viewId){
	Homey.showView(viewId);
});
Homey.on('close', function(){
	Homey.close();
});
Homey.on('nextView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) + 1;
	if(viewIndex > 0 && viewIndex < viewsIds.length){
		Homey.showView(viewsIds[viewIndex]);
	}
});
Homey.on('previousView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) - 1;
	if(viewIndex >= 0){
		Homey.showView(viewsIds[viewIndex]);
	}
});
function nextView(){
	if(options.next){
		Homey.nextView();
	}else{
		Homey.emit('next');
	}
}
</script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<div class="centered-container">
	<div id="image-container"></div>
	<div id="body"><span class="content"></span></div>
	<div class="foundAnimation" id="foundBackground" style="display:none;"></div>
	<i class="fa fa-check-circle foundAnimation" id="found" style="display:none;" aria-hidden="true"></i>
</div>

<script>
	var idPrefix = '[data-id="' + options.id + '"] ';
	$(idPrefix + '#body > span').html(__(options.body));
	var $imageContainer = $(idPrefix + '#image-container');
	$imageContainer.css('width', options.svgWidth).css('height', options.svgHeight);

	$imageContainer.html(options.svg);
	$imageContainer.highlight();

	var found = false;
	Homey.on('frame', function (data) {
		if(!found) {
			found = true;
			Homey.emit('set_device', data, function (err, device) {
				if (err) {
					if((err.message || err) !== '433_generator.error.invalid_device') {
						Homey.alert(err.message && err.message.indexOf(' ') === -1 && __(err.message) !== err.message ? __(err.message) : JSON.stringify(err));
					}
					found = false;
					return;
				}
				const dataKey = JSON.stringify(device.data);
				window.selected_devices = [ dataKey ];
				window.found_devices = {};
				window.found_devices[dataKey] = device;
				var $foundElems = $(idPrefix + '.foundAnimation');
				$foundElems.show();
				setTimeout(function () {
					$foundElems.addClass('fadeOut');
					setTimeout(nextView, 400);
				}, 500);
			});
		}
	});
</script>

<style>
	#found {
		z-index: 2;
		position: absolute;
		top: 20vh;
		left: 38vw;
		font-size: 30vh;
		color: #080;
		opacity: 1;
	}

	#foundBackground {
		z-index: 1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		position: absolute;
		background-color: #FFF;
		opacity: 0.8;
	}

	.fadeOut {
		-webkit-transition: all 0.5s ease-in-out;
		-moz-transition: all 0.5s ease-in-out;
		-ms-transition: all 0.5s ease-in-out;
		-o-transition: all 0.5s ease-in-out;
		transition: all 0.5s ease-in-out;
		opacity: 0 !important;
	}
</style>