<script>
var options = {
	template: '../lib/pair/program.html',
	id: 'generic_program',
	previous: 'generic_choice',
	title: 'deviceClasses.build_in.views.generic_program.title',
	body: 'deviceClasses.build_in.views.generic_program.body',
	svg: '<?xml version="1.0" encoding="utf-8"?>\n<!-- Generator: Adobe Illustrator 20.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1457.2 1070.2" style="enable-background:new 0 0 1457.2 1070.2;" xml:space="preserve">\n<g>\n\t<path d="M616.9,944.8h-94.4v75.8h94.4V944.8z M614.1,1017.7h-88.7v-70.1h88.7V1017.7z"/>\n\t<path d="M599,866.4h-58.6v65.3H599V866.4z M596.2,928.9h-53v-59.6h53V928.9z"/>\n\t<path d="M724.1,1020.6v-75.8h-94.4v75.8H724.1z M632.5,947.6h88.7v70.1h-88.7V947.6z"/>\n\t<path d="M706.2,866.4h-58.6v65.3h58.6V866.4z M703.4,928.9h-53v-59.6h53V928.9z"/>\n\t<path d="M831.3,944.8h-94.4v75.8h94.4V944.8z M828.4,1017.7h-88.7v-70.1h88.7V1017.7z"/>\n\t<path d="M813.4,866.4h-58.6v65.3h58.6V866.4z M810.5,928.9h-53v-59.6h53V928.9z"/>\n\t<path d="M938.4,1020.6v-75.8H844v75.8H938.4z M846.9,947.6h88.7v70.1h-88.7V947.6z"/>\n\t<path d="M920.5,866.4h-58.6v65.3h58.6V866.4z M917.7,928.9h-53v-59.6h53V928.9z"/>\n\t<polygon points="669.4,956.9 659.2,956.9 659.2,1006.7 694.5,1006.7 694.5,998.2 669.4,998.2 \t"/>\n\t<polygon points="903,990.5 882.3,956.9 872.5,956.9 872.5,1007.1 881.9,1007.1 881.9,974.1 902.2,1007.1 912.4,1007.1 912.4,956.9 \n\t\t903,956.9 \t"/>\n\t<polygon points="773.5,974.1 793.8,1007.1 804,1007.1 804,956.9 794.6,956.9 794.6,990.5 773.9,956.9 764.1,956.9 764.1,1007.1 \n\t\t773.5,1007.1 \t"/>\n\t<path d="M559.3,985.1l-17.3,15.3l4.7,5.3l18.6-16.4c0,0,0.1,0,0.1,0.1c6,4.4,12.9,9.5,21.1,9.5c5.6,0,11.9-2.4,18.9-9l-4.9-5.2\n\t\tc-12.5,11.8-20.3,6.8-29.8-0.2l16.8-14.9l1.5,1.7l4.1-11.4l-11.8,2.6l1.5,1.7l-18,15.9c-8.1-5.5-17.9-9.9-30.2-2.2l3.8,6\n\t\tC546.4,979,552.3,980.6,559.3,985.1z"/>\n\t<path d="M1398.2,503.1h-59c-10.9,0-19.8,8.9-19.8,19.8v26.3c0,10.9,8.9,19.8,19.8,19.8h59c18.2,0,32.9-14.8,32.9-32.9\n\t\tS1416.4,503.1,1398.2,503.1z M1398.2,565.5h-59c-9,0-16.3-7.3-16.3-16.3V523c0-9,7.3-16.3,16.3-16.3h59c16.2,0,29.4,13.2,29.4,29.4\n\t\tC1427.6,552.3,1414.5,565.5,1398.2,565.5z"/>\n\t<path d="M1441.7,471h-177.9V266c0-3.9-1.6-7.5-4.2-10.1c-47.7-55.2-82.8-94.5-120-131.9c-37.5-37.7-76.8-73.2-132.7-120.7\n\t\tc-2.7-2.2-5.9-3.3-9.1-3.3v0H732h-1.5H464.7c-3.8,0-7.3,1.5-9.9,4c-55.6,47.2-94.7,82.5-132,120.1\n\t\tc-37.4,37.6-72.7,77.1-120.7,132.7c-2.3,2.7-3.4,6-3.4,9.2h0v203.1H15.5c-8.6,0-15.5,7-15.5,15.5V586c0,8.6,7,15.5,15.5,15.5h183.1\n\t\tv202.7c0,3.9,1.6,7.5,4.2,10.1c47.7,55.2,82.8,94.5,120,131.9c37.5,37.7,76.8,73.2,132.7,120.7c2.7,2.2,5.9,3.3,9.1,3.3v0h265.8\n\t\th1.5h265.8c3.8,0,7.3-1.5,9.9-4c55.6-47.2,94.7-82.5,132-120.1c37.4-37.6,72.7-77.1,120.7-132.7c2.3-2.7,3.4-6,3.4-9.2h0V603.3\n\t\th177.9c8.6,0,15.5-7,15.5-15.5V486.5C1457.2,477.9,1450.3,471,1441.7,471z M1263.9,548.6l-0.2-13.3h0.1V535c0-0.4,0-0.7,0-1\n\t\tl0.2-13.6c0-0.8,0-1.5-0.1-2.2v-11.5h12.9c4.2,0,7.6,3.4,7.6,7.6v43.7c0,4.2-3.4,7.6-7.6,7.6h-12.9v-13c0.1-0.8,0.2-1.6,0.2-2.4\n\t\tC1264,549.6,1264,549.1,1263.9,548.6z M198.5,521.6l0.2,13.3h-0.1v0.3c0,0.4,0,0.7,0,1l-0.2,13.6c0,0.8,0,1.5,0.1,2.2v11.5h-18.1\n\t\tc-4.2,0-7.6-3.4-7.6-7.6v-43.7c0-4.2,3.4-7.6,7.6-7.6h18.1v13c-0.1,0.8-0.2,1.6-0.2,2.4C198.4,520.7,198.4,521.2,198.5,521.6z\n\t\t M15.5,598c-6.6,0-12-5.4-12-12V484.6c0-6.6,5.4-12,12-12h183.1v28.6h-18.1c-6.1,0-11.1,5-11.1,11.1v43.7c0,6.1,5,11.1,11.1,11.1\n\t\th18.1V598H15.5z M941.3,854.8v201.2H837.9V854.8H941.3z M837.4,854.8v201.2H732h-1.2V854.8H837.4z M730.2,854.8v201.2H623.6V854.8\n\t\tH730.2z M623,1056.1H519.7V854.8H623V1056.1z M1249.8,550.1h-0.2v254.1c-95.6,110.7-140.5,157.4-251.9,251.9h-49.4V847.7H512.6\n\t\tv208.3h-47.9c-111.4-94.5-156.3-141.2-251.9-251.9V550.1h-0.2l0.2-14.8V535l-0.2-14.8h0.2V266c95.6-110.7,140.5-157.4,251.9-251.9\n\t\th265.8h1.5h265.8c111.4,94.5,156.3,141.2,251.9,251.9v254.1h0.2l-0.2,14.8v0.3L1249.8,550.1z M1453.7,587.8c0,6.6-5.4,12-12,12\n\t\th-177.9V569h12.9c6.1,0,11.1-5,11.1-11.1v-43.7c0-6.1-5-11.1-11.1-11.1h-12.9v-28.6h177.9c6.6,0,12,5.4,12,12V587.8z"/>\n\t<path d="M118,501.3H59c-18.2,0-32.9,14.8-32.9,32.9c0,18.2,14.8,32.9,32.9,32.9h59c10.9,0,19.8-8.9,19.8-19.8v-26.3\n\t\tC137.8,510.2,128.9,501.3,118,501.3z M134.3,547.4c0,9-7.3,16.3-16.3,16.3H59c-16.2,0-29.4-13.2-29.4-29.4s13.2-29.4,29.4-29.4h59\n\t\tc9,0,16.3,7.3,16.3,16.3V547.4z"/>\n\t<path d="M988.6,91.2H481.9l-94.8,94.8v285c0,26.4,21.5,48,48,48h601.6c26.4,0,48-21.5,48-48V187.3l-95.2-95.2L988.6,91.2z\n\t\t M1079,471c0,23.3-19,42.3-42.3,42.3H435.1c-23.3,0-42.3-19-42.3-42.3V188.4l91.5-91.5h502l92.7,92.7V471z"/>\n</g>\n</svg>\n',
	svgWidth: '80vw',
	svgHeight: '70vh',
	initWithDeviceData: false,
	next: true
};
Homey.setTitle(__(options.title || ''));
Homey.emit('init', options.id);
Homey.on('show_view', function(viewId){
	Homey.showView(viewId);
});
Homey.on('close', function(){
	Homey.close();
});
Homey.on('nextView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) + 1;
	if(viewIndex > 0 && viewIndex < viewsIds.length){
		Homey.showView(viewsIds[viewIndex]);
	}
});
Homey.on('previousView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) - 1;
	if(viewIndex >= 0){
		Homey.showView(viewsIds[viewIndex]);
	}
});
function nextView(){
	if(options.next){
		Homey.nextView();
	}else{
		Homey.emit('next');
	}
}
</script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<div class="centered-container">
	<div id="image-container"></div>
	<div id="body"><span class="content"></span></div>
	<div class="programAnimation" id="sendProgramSignalBackground" style="display:none;"></div>
	<i class="loading fa fa-cog fa-spin programAnimation" id="sendProgramSignalSpinner" style="display:none;"></i>
</div>

<script>
	var $container = $('[data-id="' + options.id + '"] ');
	$container.find('#body > span').html(__(options.body));
	var $imageContainer = $container.find('#image-container');
	$imageContainer.css('width', options.svgWidth).css('height', options.svgHeight);
	var $programElems = $container.find('.programAnimation');

	$imageContainer.html(options.svg);
	$imageContainer.highlight();

	if (!$container.find('.view-navigation-next.dummy').length) {
		var $nextButton = $container.find('.view-navigation-next');
		var $nextButtonDummy = $nextButton.clone().addClass('dummy');
		$nextButton.hide();
		$nextButton.parent().append($nextButtonDummy);

		$nextButtonDummy.on('click', function (e) {
			$programElems.show();
			Homey.emit('program_send', function (err) {
				if (err){
					Homey.alert(err.message && err.message.indexOf(' ') === -1 && __(err.message) !== err.message ? __(err.message) : JSON.stringify(err));
					return;
				}
				$nextButtonDummy.siblings('.view-navigation-next').click();
				$programElems.hide();
			});
			e.stopPropagation();
			return false;
		});
	}

	Homey.emit('program', function(err, device){
		const dataKey = JSON.stringify(device.data);
		window.selected_devices = [ dataKey ];
		window.found_devices = {};
		window.found_devices[dataKey] = device;
	});
</script>

<style>
	#sendProgramSignalSpinner {
		z-index: 2;
		position: absolute;
		top: 25vh;
		left: 38vw;
		font-size: 9vh;
		opacity: 1;
	}

	#sendProgramSignalBackground {
		z-index: 1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		position: absolute;
		background-color: #FFF;
		opacity: 0.8;
	}
</style>