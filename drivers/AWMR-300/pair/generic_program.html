<script>
var options = {
	template: '../lib/pair/program.html',
	id: 'generic_program',
	previous: 'generic_choice',
	title: 'deviceClasses.build_in.views.generic_program.title',
	body: 'deviceClasses.build_in.views.generic_program.body',
	svg: '<?xml version="1.0" encoding="utf-8"?>\n<!-- Generator: Adobe Illustrator 20.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->\n<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n\t viewBox="0 0 1056.3 1273.3" style="enable-background:new 0 0 1056.3 1273.3;" xml:space="preserve" xmlns:pulse="-">\n<g>\n\t<polygon points="257.9,873.1 257.9,926.2 290.7,926.2 290.7,919.1 265,919.1 265,873.1 \t"/>\n\t<path d="M94.1,1148.2c22.6,0,41-18.4,41-41s-18.4-41-41-41s-41,18.4-41,41S71.5,1148.2,94.1,1148.2z M94.1,1069.8\n\t\tc20.6,0,37.4,16.8,37.4,37.4s-16.8,37.4-37.4,37.4s-37.4-16.8-37.4-37.4S73.4,1069.8,94.1,1069.8z"/>\n\t<path d="M271.5,1148.2c22.6,0,41-18.4,41-41s-18.4-41-41-41s-41,18.4-41,41S248.9,1148.2,271.5,1148.2z M271.5,1069.8\n\t\tc20.6,0,37.4,16.8,37.4,37.4s-16.8,37.4-37.4,37.4s-37.4-16.8-37.4-37.4S250.8,1069.8,271.5,1069.8z"/>\n\t<path d="M1056.3,256c0-1.9-0.7-3.7-2.1-5L982,178.8c-1.3-1.3-3.1-2.1-5-2.1H674v-33.8c0-2.9-2.4-5.3-5.3-5.3h-44.8V0h-40.2v137.5\n\t\tH465.2V0H425v137.5h-48.2c-2.9,0-5.3,2.4-5.3,5.3v33.8H80c-1.9,0-3.7,0.7-5,2.1L2.8,250.9c-1.3,1.3-2.1,3.1-2.1,5v713.6h5\n\t\tC2.3,971.3,0,974.9,0,979v258.1c0,5.9,4.8,10.6,10.6,10.6h25.5v16c0,5.3,4.3,9.6,9.6,9.6h286c5.3,0,9.6-4.3,9.6-9.6v-16h13.6\n\t\tc5.9,0,10.6-4.8,10.6-10.6V979c0-5.9-4.8-10.6-10.6-10.6h-340V258.9l68-68h270.3V309c0,25,20.3,45.3,45.3,45.3h251\n\t\tc25,0,45.3-20.3,45.3-45.3V190.9h279.3l68,68v708.6H701.2c-5.9,0-10.6,4.8-10.6,10.6V1175H366.4v14.2h324.2v47.1\n\t\tc0,5.9,4.8,10.6,10.6,10.6H714v16.8c0,5.3,4.3,9.6,9.6,9.6h286c5.3,0,9.6-4.3,9.6-9.6v-16.8h26.2c5.9,0,10.6-4.8,10.6-10.6V978.1\n\t\tc0-3.8-2-7.1-5-9h5.2V256H1056.3z M587.2,3.5h33.1v134h-33.1V3.5z M428.5,3.5h33.1v134h-33.1V3.5z M378.5,144.6h288.4v31.5H378.5\n\t\tV144.6z M334.3,1263.7c0,1.4-1.1,2.5-2.5,2.5h-286c-1.4,0-2.5-1.1-2.5-2.5v-16h291V1263.7z M358.5,979v258.1c0,2-1.6,3.5-3.5,3.5\n\t\tH10.6c-2,0-3.5-1.6-3.5-3.5V979c0-2,1.6-3.5,3.5-3.5h344.3C356.9,975.4,358.5,977,358.5,979z M687.7,308.9\n\t\tc0,21.1-17.1,38.2-38.2,38.2h-251c-21.1,0-38.2-17.1-38.2-38.2v-118h327.4L687.7,308.9L687.7,308.9z M1012.2,1263.7\n\t\tc0,1.4-1.1,2.5-2.5,2.5h-286c-1.4,0-2.5-1.1-2.5-2.5v-16.8h291V1263.7z M1049,1236.2c0,2-1.6,3.5-3.5,3.5H701.2\n\t\tc-2,0-3.5-1.6-3.5-3.5V978.1c0-2,1.6-3.5,3.5-3.5h344.3c2,0,3.5,1.6,3.5,3.5V1236.2z"/>\n\t<path d="M120.3,313.8c0,9.8,8,17.8,17.8,17.8s17.8-8,17.8-17.8s-8-17.8-17.8-17.8S120.3,304,120.3,313.8z M152.4,313.8\n\t\tc0,7.9-6.4,14.2-14.2,14.2c-7.9,0-14.2-6.4-14.2-14.2c0-7.9,6.4-14.2,14.2-14.2C146,299.6,152.4,306,152.4,313.8z"/>\n\t<polygon points="933.9,873.1 933.9,926.2 966.7,926.2 966.7,919.1 940.9,919.1 940.9,873.1 \t"/>\n\t<path d="M784.6,1071.3c-22.6,0-41,18.4-41,41s18.4,41,41,41s41-18.4,41-41S807.2,1071.3,784.6,1071.3z M784.6,1149.8\n\t\tc-20.6,0-37.4-16.8-37.4-37.4s16.8-37.4,37.4-37.4s37.4,16.8,37.4,37.4S805.3,1149.8,784.6,1149.8z"/>\n\t<path d="M962.1,1071.3c-22.6,0-41,18.4-41,41s18.4,41,41,41s41-18.4,41-41S984.7,1071.3,962.1,1071.3z M962.1,1149.8\n\t\tc-20.6,0-37.4-16.8-37.4-37.4s16.8-37.4,37.4-37.4s37.4,16.8,37.4,37.4S982.7,1149.8,962.1,1149.8z"/>\n\t<polygon points="986.3,866.9 986.3,900.1 975.4,900.1 988.4,926.1 1001.4,900.1 990.5,900.1 990.5,866.9 \t"/>\n\t<path d="M269.2,287.1c-14.7,0-26.7,12-26.7,26.7s12,26.7,26.7,26.7c14.7,0,26.7-12,26.7-26.7C295.9,299.1,284,287.1,269.2,287.1z\n\t\t M269.2,337c-12.8,0-23.2-10.4-23.2-23.2c0-12.8,10.4-23.2,23.2-23.2s23.2,10.4,23.2,23.2C292.4,326.6,282,337,269.2,337z"/>\n\t<path d="M580.6,302.5c10.9,0,19.9-8,21.6-18.3h38.4c3.8,0,6.9-3.1,6.9-6.9V220h-7.1v57.2h-38.2c-1.7-10.4-10.7-18.3-21.6-18.3\n\t\tc-12.1,0-21.9,9.8-21.9,21.9S568.5,302.5,580.6,302.5z M580.6,265.8c8.2,0,14.8,6.6,14.8,14.8s-6.6,14.8-14.8,14.8\n\t\ts-14.8-6.6-14.8-14.8S572.4,265.8,580.6,265.8z"/>\n\t<path d="M417.2,284.2h38.5c1.7,10.4,10.7,18.3,21.6,18.3c3.9,0,7.5-1,10.6-2.8l59,33.8l3.5-6.1l-56.6-32.5\n\t\tc3.3-3.8,5.4-8.9,5.4-14.3c0-12.1-9.8-21.9-21.9-21.9c-10.9,0-19.9,8-21.6,18.3h-38.3v-57.2h-7.1v57.3\n\t\tC410.2,281,413.3,284.2,417.2,284.2z M477.2,265.8c8.2,0,14.8,6.6,14.8,14.8s-6.6,14.8-14.8,14.8s-14.8-6.6-14.8-14.8\n\t\tS469.1,265.8,477.2,265.8z"/>\n\t<polygon points="798.3,926.1 805.6,926.1 805.6,873.1 798.8,873.1 798.8,914.7 771,873.1 763.7,873.1 763.7,926.1 770.5,926.1\n\t\t770.5,884.5 \t"/>\n\t<polygon points="80.4,873.1 73.2,873.1 73.2,926.1 79.9,926.1 79.9,884.5 107.7,926.1 115,926.1 115,873.1 108.2,873.1\n\t\t108.2,914.7 \t"/>\n</g>\n<g>\n\t<path pulse:initial="true" fill="white" d="M269.2,294.5c10.7,0,19.3,8.6,19.3,19.3c0,10.7-8.6,19.3-19.3,19.3c-10.7,0-19.3-8.6-19.3-19.3\n\t\tC249.9,303.2,258.6,294.5,269.2,294.5"/>\n</g>\n<g>\n\t<path d="M138.1,300.3c7.5,0,13.5,6,13.5,13.5s-6,13.5-13.5,13.5s-13.5-6-13.5-13.5\n\t\tC124.6,306.4,130.7,300.3,138.1,300.3"/>\n</g>\n</svg>\n',
	svgWidth: '80vw',
	svgHeight: '70vh',
	initWithDeviceData: false,
	next: true
};
Homey.setTitle(__(options.title || ''));
Homey.emit('init', options.id);
Homey.on('show_view', function(viewId){
	Homey.showView(viewId);
});
Homey.on('close', function(){
	Homey.close();
});
Homey.on('nextView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) + 1;
	if(viewIndex > 0 && viewIndex < viewsIds.length){
		Homey.showView(viewsIds[viewIndex]);
	}
});
Homey.on('previousView', function(viewsIds){
	var viewIndex = viewsIds.indexOf(options.id) - 1;
	if(viewIndex >= 0){
		Homey.showView(viewsIds[viewIndex]);
	}
});
function nextView(){
	if(options.next){
		Homey.nextView();
	}else{
		Homey.emit('next');
	}
}
</script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<link href="../../../assets/433_generator/css/styles.css" rel="stylesheet" type="text/css"/>

<link href="../../../assets/433_generator/css/svg.css" rel="stylesheet" type="text/css"/>

<script src="../../../assets/433_generator/js/svghighlighter.js" type="text/javascript"></script>

<div class="centered-container">
	<div id="image-container"></div>
	<div id="body"><span class="content"></span></div>
	<div class="programAnimation" id="sendProgramSignalBackground" style="display:none;"></div>
	<i class="loading fa fa-cog fa-spin programAnimation" id="sendProgramSignalSpinner" style="display:none;"></i>
</div>

<script>
	var $container = $('[data-id="' + options.id + '"] ');
	$container.find('#body > span').html(__(options.body));
	var $imageContainer = $container.find('#image-container');
	$imageContainer.css('width', options.svgWidth).css('height', options.svgHeight);
	var $programElems = $container.find('.programAnimation');

	$imageContainer.html(options.svg);
	$imageContainer.highlight();

	if (!$container.find('.view-navigation-next.dummy').length) {
		var $nextButton = $container.find('.view-navigation-next');
		var $nextButtonDummy = $nextButton.clone().addClass('dummy');
		$nextButton.hide();
		$nextButton.parent().append($nextButtonDummy);

		$nextButtonDummy.on('click', function (e) {
			$programElems.show();
			Homey.emit('program_send', function (err) {
				if (err){
					Homey.alert(err.message && err.message.indexOf(' ') === -1 && __(err.message) !== err.message ? __(err.message) : JSON.stringify(err));
					return;
				}
				$nextButtonDummy.siblings('.view-navigation-next').click();
				$programElems.hide();
			});
			e.stopPropagation();
			return false;
		});
	}

	Homey.emit('program', function(err, device){
		const dataKey = JSON.stringify(device.data);
		window.selected_devices = [ dataKey ];
		window.found_devices = {};
		window.found_devices[dataKey] = device;
	});
</script>

<style>
	#sendProgramSignalSpinner {
		z-index: 2;
		position: absolute;
		top: 25vh;
		left: 38vw;
		font-size: 9vh;
		opacity: 1;
	}

	#sendProgramSignalBackground {
		z-index: 1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		position: absolute;
		background-color: #FFF;
		opacity: 0.8;
	}
</style>